<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- Подключение Bootstrap чтобы все выглядело красиво -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css">
    <title>Private rooms</title>
    <!-- Свои стили -->
    <style>
        body {
            background: #fcfcfc;
        }
    </style>
</head>
<body>
<!--Создание меню на сайте (без функций)-->
<div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
    <h5 class="my-0 mr-md-auto">Chat</h5>
    <nav class="my-2 my-md-0 mr-md-3">
        <a class="p-2 text-dark" href="https://chatkopp.herokuapp.com/api/chat">Public chat</a>
        <a class="p-2 text-dark" href="https://chatkopp.herokuapp.com/api/chat/private/login/">Private chat login</a>
    </nav>
    <a class="btn btn-outline-primary" href="https://chatkopp.herokuapp.com/api/chat/private/register/">Create Private
        Chat</a>
</div>
<!-- Основная часть страницы -->
<div class="container">
    <div class="py-5 text-center">
        <h2>Create your private chat</h2>
        <p class="lead">Enter your chat name and password</p>
    </div>
    <div class="row">
        <div class="col-12 text-center">
            <!-- Форма для получения сообщений и имени -->
            <h3 align="center">Register form</h3>
            <form id="credentials" onsort="fet()">
                <label for="chat_name">Chat name</label>
                <input type="text" name="name" id="chat_name" placeholder="Enter chat name" class="form-control"
                       style="text-align:center;">
                <br>
                <label for="chat_pass">Chat pass</label>
                <input type="text" name="pass" id="chat_pass" placeholder="Enter chat pass"
                       class="form-control" style="text-align:center;">
                <br>
                <input type="button" value="Register" class="btn btn-danger" onclick="f()">
            </form>
        </div>

    </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">

    // setInterval(function(){ajax()},1000);
    function f() {
        var $name = $("#chat_name"); // Поле с именем
        var $pass = $("#chat_pass"); // Текстовое поле
        var req = new XMLHttpRequest();
        var body = 'name=' + encodeURIComponent($name.val()) +
            '&pass=' + encodeURIComponent($pass.val());

        req.open("POST", 'https://chatkopp.herokuapp.com/auth/create', true);
        req.setRequestHeader("Content-type", "application/x-www-form-urlencoded");


        req.send(body);

        req.onreadystatechange = function () { // (3)
            if (req.readyState != 4) return;

            if (req.status != 200) {
                alert("Room already exist");
            } else {
                alert("Room created successfully");
                window.location.replace("https://chatkopp.herokuapp.com/api/chat/private/login/");
            }
        }
    }
</script>

</body>
</html>